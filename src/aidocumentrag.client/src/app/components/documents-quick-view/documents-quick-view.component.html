<div class="sidebar">
  <!-- Top Bar -->
  <div class="top-bar">
    <div class="top-bar-left">
      <div class="logo">P</div>
    </div>
    <div class="top-bar-right">
      <button class="icon-button upload-trigger-btn" 
              (click)="openUploadModal()" 
              title="Upload Documents">
        📁 Upload
      </button>
      <!--<button class="icon-button">📱</button>
      <button class="icon-button">🔔</button>
      <div class="user-avatar">A</div>-->
    </div>
  </div>

  <div class="sidebar-section">
    <div class="section-header">
      <div class="section-title">{{ sectionTitle }}</div>
      <div class="section-controls">
        <button type="button" 
                class="refresh-btn" 
                (click)="refreshDocuments()"
                title="Refresh documents"
                [disabled]="isLoading">
          🔄 Refresh
        </button>
        <div class="selection-controls" *ngIf="displayFiles.length > 0">
          <label class="multi-select-toggle">
            <input type="checkbox"
                   [checked]="isMultiSelectMode"
                   (change)="onMultiSelectToggle($event)">
            <span class="toggle-text">Multi-select</span>
          </label>
        </div>
      </div>
    </div>

    <!-- Search Container -->
    <div class="search-container">
      <input type="text"
             class="search-box"
             [(ngModel)]="searchQuery"
             (input)="onSearchInput($event)"
             (keydown)="onSearchKeydown($event)"
             placeholder="Search documents..."
             [class.active]="searchState.isActive">
      <button class="search-clear-btn"
              *ngIf="searchState.isActive"
              (click)="onSearchClear()"
              title="Clear search">
        ✕
      </button>
    </div>

    <!-- Search State Indicator -->
    <div class="search-indicator" *ngIf="isSearchActive">
      <div class="search-info">
        <span class="search-icon">🔍</span>
        <span class="search-text">Showing search results</span>
      </div>
    </div>

    <!-- Documents List -->
    <div class="documents-list">
      <div *ngFor="let file of displayFiles; trackBy: trackByFileName"
           class="sidebar-item"
           [class.active]="isDocumentSelected(file)"
           (click)="onFileClick(file)">

        <div class="item-checkbox" *ngIf="isMultiSelectMode" (click)="$event.stopPropagation()">
          <input type="checkbox"
                 [checked]="selectedDocuments.has(getFileKey(file))"
                 (change)="onCheckboxChange(file, $event)">
        </div>

        <span class="sidebar-icon">{{ getFileIcon(file.fileExtension) }}</span>
        <div class="file-info">
          <div class="file-name">{{ file.fileName }}</div>
          <div class="file-meta">{{ formatFileSize(file.fileSize) }}</div>
        </div>

        <!-- File Actions -->
        <div class="file-actions" (click)="$event.stopPropagation()">
          <button type="button" 
                  class="action-btn rename-btn" 
                  (click)="renameFile(file)"
                  title="Rename file"
                  [disabled]="isUploading">
            ✏️
          </button>
          <button type="button" 
                  class="action-btn remove-btn" 
                  (click)="removeFile(file)"
                  title="Remove file"
                  [disabled]="isUploading">
            🗑️
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-indicator">
    <div class="loading-text">Loading documents...</div>
  </div>

  <!-- Empty States -->
  <div *ngIf="!isLoading && displayFiles.length === 0 && !isSearchActive" class="empty-state">
    <div class="empty-icon">📁</div>
    <div class="empty-text">No documents found</div>
  </div>

  <div *ngIf="!isLoading && displayFiles.length === 0 && isSearchActive" class="empty-state">
    <div class="empty-icon">🔍</div>
    <div class="empty-text">
      <div class="empty-title">No matching documents</div>
      <div class="empty-subtitle">Try adjusting your search terms</div>
    </div>
  </div>

  <!-- Footer -->
  <!--<div class="sidebar-footer">
    <div class="sidebar-item" (click)="onHelpClick()">
      <span class="sidebar-icon">❓</span>
      <div class="file-info">
        <div class="file-name">Help</div>
      </div>
    </div>
  </div>-->

  <!-- File Upload Modal -->
  <app-file-upload-modal 
    (fileUploaded)="onFileUploaded($event)"
    (uploadError)="onUploadError($event)"
    (closeModal)="onUploadModalClosed()">
  </app-file-upload-modal>
</div>
